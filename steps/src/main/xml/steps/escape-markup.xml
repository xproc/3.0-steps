<section xmlns="http://docbook.org/ns/docbook" xmlns:cs="http://www.w3.org/XML/XProc/2006/04/components#" xmlns:e="http://www.w3.org/1999/XSL/Spec/ElementSyntax" xmlns:p="http://www.w3.org/ns/xproc" xmlns:xi="http://www.w3.org/2001/XInclude" xmlns:xlink="http://www.w3.org/1999/xlink" xml:id="c.escape-markup">
<title>p:escape-markup</title>

<para>The <code>p:escape-markup</code> step serializes an XML or HTML
document and returns the serialized form. In other words, it
transforms the <emphasis>tag</emphasis> “<code>&lt;tag/&gt;</code>”
into the <emphasis>text</emphasis>
“<code>&amp;lt;tag/&amp;gt;</code>”. This operation can be reversed with the
<tag>p:unescape-markup</tag> step.</para>

<p:declare-step type="p:escape-markup">
  <p:input port="source" content-types="xml html"/>
  <p:output port="result" content-types="text"/>
  <p:option name="serialization" as="map(xs:QName,item()*)?"/>
</p:declare-step>

<para>This step supports the standard serialization options as
specified in <link linkend="xml-serialization-31"/>. These options
control how the serialization is performed.
</para>

<para>For example, the input:</para>

<programlisting language="xml"><![CDATA[<div xmlns="http://www.w3.org/1999/xhtml">
<p>This is a chunk of XHTML.</p>
</div>]]></programlisting>

<para>produces:</para>

<programlisting language="xml"><![CDATA[&lt;div xmlns="http://www.w3.org/1999/xhtml"&gt;
&lt;p>This is a chunk of XHTML.&lt;/p&gt;
&lt;/div&gt;]]></programlisting>

<note xml:id="note-escaped">
<para>The result of this step is a text document (a data model
instance) that contains the Unicode characters that are the characters
that result from escaping the input. It <emphasis>is not</emphasis>
encoded characters in a serialized octet stream, therefore, the
serialization options related to encoding characters
(<option>byte-order-mark</option>, <option>encoding</option>, and
<option>normalization-form</option>) do not apply. They <rfc2119>must</rfc2119>
be ignored by the processor.</para>
</note>

<para>By default, this step <rfc2119>must not</rfc2119> generate an
XML declaration in the escaped result.</para>

<simplesect>
<title>Document properties</title>
<para feature="escape-markup-preserves-all">All document properties are preserved.</para>
</simplesect>
</section>
